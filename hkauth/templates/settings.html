{% extends "base.html" %}

{% block body %}
<div class="row">
	<div class="col-sm-12">
		<h1>{{ _('SETTINGS_TITLE') }}</h1>
		<p>{{ _('SETTINGS_INTRO') }}</h1>
	</div>
</div>

<div class="row settings_section">
	<div class="col-sm-12 col-md-5 col-lg-4">
		<h3>{{ _('CHARACTERS_XML_APIS_TITLE') }}</h3>
		<p>{{ _('CHARACTERS_XML_APIS_INTRO') }}</p>
		<form method="POST" action="/characters/add_xml_api">
			<input type="hidden" name="_xsrf" value="{{ handler.xsrf_token }}">

			<p>
				<label for="key_id">{{ _('CHARACTERS_XML_APIS_KEY_ID_LABEL') }}</label>
				<input id="key_id" name="key_id" type="text" placeholder="{{ _('CHARACTERS_XML_APIS_KEY_ID_PLACEHOLDER') }}">
				<span class="help">{{ _('CHARACTERS_XML_APIS_KEY_ID_HELP') }}</span>
			</p>

			<p>
				<label for="v_code">{{ _('CHARACTERS_XML_APIS_V_CODE_LABEL') }}</label>
				<input id="v_code" name="v_code" type="text" placeholder="{{ _('CHARACTERS_XML_APIS_V_CODE_PLACEHOLDER') }}">
				<span class="help">{{ _('CHARACTERS_XML_APIS_V_CODE_HELP') }}</span>
			</p>

			<p>
				<button type="submit">Add</button>
			</p>

		</form>
	</div>
	<div class="col-sm-12 col-md-7 col-lg-8">
		{% if not len(current_user.xml_apis) %}
		<p class="alert alert-warning">{{ _('CHARACTERS_XML_APIS_NO_APIS') }}</p>
		{% else %}
		<table class="table">
			<thead class="thead-inverse">
				<tr>
					<th>KeyID</th>
					<th>vCode</th>
					<th>Status</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
			{% for api in current_user.xml_apis %}
				<tr>
					<td>{{ api.key_id }}</td>
					<td>{{ api.v_code[:12] }}...</td>
					<td>{{ api.status }}</td>
					<td><a href="#">edit</a> / <a href="#">delete</a></td>
				</tr>
			{% end %}
			</tbody>
		</table>
		{% end %}
	</div>
</div>
<div class="row characters_section">
	<div class="col-sm-12 col-md-5 col-lg-4">
		<h2>{{ _('CHARACTERS_CHARACTERS_TITLE') }}</h2>
		{% raw _('CHARACTERS_CHARACTERS_INTRO') %}</p>
		<h3>{{ _('CHARACTERS_CHARACTERS_MAIN_TITLE') }}</h3>
		<form method="POST" action="/characters/select_main">
			<input type="hidden" name="_xsrf" value="{{ handler.xsrf_token }}">
			<p>
				<select id="main_character" name="character_id">
					<option value="0">{{ _('CHARACTERS_CHARACTERS_NO_MAIN_SELECTED') }}</option>
					{% for character in current_user.characters %}
						{% if character.is_internal %}
							{% if current_user.main_character == character %}
								<option selected value="{{ character.id }}">{{ character.character_name }}</option>
							{% else %}
								<option value="{{ character.id }}">{{ character.character_name }}</option>
							{% end %}
						{% end %}
					{% end %}
				</select>
				<button type="submit">Set</button>
			</p>
		</form>
	</div>
	<div class="col-sm-12 col-md-7 col-lg-8">
		{% if not len(current_user.xml_apis) %}
		<p class="alert alert-warning">{{ _('CHARACTERS_CHARACTERS_NO_CHARACTERS') }}</p>
		{% else %}
		<table class="table">
			<thead class="thead-inverse">
				<tr>
					<th></th>
					<th>Character</th>
					<th>Corporation</th>
					<th>Alliance</th>
				</tr>
			</thead>
			<tbody>
			{% for character in current_user.characters %}
				{% if character.is_internal %}
					{% if current_user.main_character == character %}
						<tr class="internal main">
					{% else %}
						<tr class="internal">
					{% end %}
				{% else %}
					<tr>
				{% end %}
					<td><img src="https://image.eveonline.com/Character/{{ character.character_id }}_50.jpg"></td>
					<td>{{ character.character_name }}</td>
					<td>{{ character.corporation_name }}</td>
					<td>{{ character.alliance_name }}</td>
				</tr>
			{% end %}
			</tbody>
		</table>
		{% end %}
	</div>
</div>
{% end %}
